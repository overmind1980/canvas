# 画板应用产品需求文档

## 1. 产品概述
一个基于Web的在线画板应用，用户可以在浏览器中进行自由绘画创作。
- 提供直观易用的绘画工具，让用户能够快速上手进行数字绘画创作，支持画笔硬度调节和多种绘画模式。
- 面向所有年龄段的用户，特别是喜欢二次元风格的绘画爱好者、学生和设计师。
- 通过简单的Web界面提供专业级的绘画体验，使用原生HTML+CSS+JavaScript开发，无需安装任何软件。

## 2. 核心功能

### 2.1 用户角色
由于是简单的画板应用，不需要复杂的用户角色区分，所有用户都具有相同的功能权限。

### 2.2 功能模块
我们的画板应用包含以下主要页面：
1. **主画板页面**：画布区域、工具栏、颜色选择器、画笔设置面板、图像上传模块
2. **作品展示页面**：作品缩略图展示、作品详情查看
3. **帮助说明页面**：使用教程、快捷键说明

### 2.3 页面详情

| 页面名称 | 模块名称 | 功能描述 |
|----------|----------|----------|
| 主画板页面 | 画布区域 | 提供绘画区域，支持鼠标和触摸绘画，实时显示绘画内容 |
| 主画板页面 | 工具栏 | 包含画笔、橡皮擦、油漆桶、基本形状工具（矩形、椭圆、三角形等）等绘画工具 |
| 主画板页面 | 颜色选择器 | 提供颜色面板选择，支持RGB调色和预设颜色 |
| 主画板页面 | 画笔设置 | 调整画笔粗细、透明度、硬度（0-100，控制边缘清晰度和羽化程度）等属性 |
| 主画板页面 | 形状设置 | 设置基本形状的线条颜色、填充颜色、线条粗细等属性 |
| 主画板页面 | 油漆桶工具 | 在封闭区域内填充指定颜色，支持容差设置 |
| 主画板页面 | 图像上传模块 | 支持上传JPG、PNG、GIF等格式图片，自动适配画布尺寸，支持拖拽移动和缩放 |
| 主画板页面 | 图像操作工具 | 对上传的图像进行移动、缩放、旋转、删除等操作，支持多图层管理 |
| 主画板页面 | 操作面板 | 撤销、重做、清空画布、保存作品到本地和服务器、导出图片功能 |
| 作品展示页面 | 作品列表 | 显示已保存的作品缩略图，支持预览和删除 |
| 作品展示页面 | 作品详情 | 查看作品完整信息，支持重新编辑和分享 |
| 帮助说明页面 | 使用教程 | 提供基本操作指南和绘画技巧说明 |
| 帮助说明页面 | 快捷键说明 | 列出所有可用的键盘快捷键 |

## 3. 核心流程

**主要用户操作流程：**
1. 用户进入主画板页面
2. 选择绘画工具（画笔、橡皮擦、油漆桶、基本形状等）或图像上传功能
3. 设置工具属性（颜色、粗细、透明度、硬度0-100等）
4. 在画布上进行绘画创作或使用油漆桶填充封闭区域
5. 使用基本形状工具绘制矩形、椭圆、三角形等，设置线条和填充
6. 上传图像文件，系统自动适配画布尺寸并放置在画布上
7. 拖拽移动上传的图像到合适位置，调整大小和角度
8. 使用撤销/重做功能调整作品
9. 保存作品到本地存储和服务器硬盘
10. 导出作品为图片文件
11. 查看已保存的作品列表

**图像上传操作流程：**
1. 点击图像上传按钮
2. 选择本地图片文件（支持JPG、PNG、GIF格式）
3. 系统自动将图像适配到画布尺寸
4. 用户可拖拽移动图像到目标位置
5. 调整图像大小、旋转角度等属性
6. 继续绘画创作或直接保存作品
7. 作品连同上传的图像一起保存到服务器

```mermaid
graph TD
    A[主画板页面] --> B[选择工具]
    A --> I[图像上传]
    B --> C[设置画笔属性]
    C --> D[开始绘画]
    I --> J[选择图片文件]
    J --> K[自动适配画布]
    K --> L[拖拽移动图像]
    L --> M[调整大小角度]
    D --> E[调整和修改]
    M --> E
    E --> F[保存作品到服务器]
    F --> G[作品展示页面]
    A --> H[帮助说明页面]
    G --> A
```

## 4. 用户界面设计

### 4.1 设计风格
- **主色调**：二次元粉色系，浅粉色背景 (#FFF0F5)，深粉色工具栏 (#FF69B4)
- **辅助色**：樱花粉按钮 (#FFB6C1)，薄荷绿保存按钮 (#98FB98)，淡紫色强调 (#DDA0DD)
- **按钮样式**：圆角矩形按钮，3D立体效果，悬停时有粉色光晕阴影
- **字体**：可爱圆润字体，标题18px，正文15px，小字13px，支持emoji表情
- **布局风格**：左侧工具栏 + 中央画布 + 右侧属性面板的经典布局，整体采用卡片式设计
- **图标风格**：可爱的二次元风格图标，支持SVG格式，带有粉色渐变效果

### 4.2 页面设计概览

| 页面名称 | 模块名称 | UI元素 |
|----------|----------|--------|
| 主画板页面 | 工具栏 | 垂直排列的可爱工具图标，选中状态粉色高亮，工具提示悬浮显示 |
| 主画板页面 | 画布区域 | 浅粉色背景，支持缩放和平移，显示淡粉色网格线辅助绘画 |
| 主画板页面 | 颜色选择器 | 粉色系色轮选择器 + RGB滑块 + 二次元风格预设颜色面板，实时预览选中颜色 |
| 主画板页面 | 画笔设置 | 粉色滑块控制粗细、透明度和硬度(0-100)，数值输入框精确设置，硬度显示羽化效果预览 |
| 主画板页面 | 形状设置 | 形状选择按钮（矩形、椭圆、三角形等），线条和填充颜色选择器，粗细调节滑块 |
| 主画板页面 | 油漆桶设置 | 容差调节滑块，填充颜色选择器，封闭区域检测提示 |
| 主画板页面 | 图像上传模块 | 粉色上传按钮，支持拖拽上传区域，文件格式提示，上传进度条显示 |
| 主画板页面 | 图像操作面板 | 图像选中时显示操作工具：移动、缩放、旋转、删除按钮，图层管理面板 |
| 主画板页面 | 操作面板 | 顶部横向排列粉色按钮，可爱图标+文字标签，快捷键提示，服务器保存突出显示 |
| 作品展示页面 | 作品列表 | 粉色卡片式网格布局缩略图，悬停显示操作按钮，支持拖拽排序 |
| 帮助说明页面 | 教程内容 | 分步骤图文说明，可折叠的粉色章节结构，配有可爱插图 |

### 4.3 响应式设计
- 桌面优先设计，支持平板和手机端适配
- 移动端优化触摸操作，增大按钮点击区域
- 支持触摸手势：双指缩放、单指平移画布
- 图像上传在移动端支持相机拍照和相册选择

## 5. 图像上传功能详细说明

### 5.1 上传功能要求
- **支持格式**：JPG、JPEG、PNG、GIF、WebP等常见图片格式
- **文件大小限制**：单个文件不超过10MB
- **上传方式**：点击按钮选择文件、拖拽文件到指定区域
- **批量上传**：支持一次选择多个图片文件
- **上传反馈**：显示上传进度条和成功/失败状态

### 5.2 图像处理功能
- **自动适配**：上传的图像自动缩放以适应画布尺寸，保持宽高比
- **智能放置**：图像默认放置在画布中心位置
- **尺寸优化**：大图片自动压缩以提高性能，小图片保持原始质量
- **格式转换**：统一转换为PNG格式以保证兼容性

### 5.3 图像操作功能
- **拖拽移动**：鼠标拖拽或触摸移动图像到任意位置
- **缩放调整**：通过拖拽角落控制点调整图像大小
- **旋转功能**：支持任意角度旋转，提供15°、30°、45°、90°快捷旋转
- **层级管理**：支持多图像层级，可调整图像前后顺序
- **透明度调节**：调整图像透明度（0-100%）
- **删除功能**：选中图像后可删除

### 5.4 服务器存储要求
- **存储路径**：上传的图像保存到服务器 `/uploads/images/` 目录
- **文件命名**：使用时间戳+随机字符串确保文件名唯一性
- **作品保存**：作品保存时包含图像文件路径信息
- **缩略图生成**：自动生成缩略图用于作品列表展示
- **存储清理**：定期清理未被引用的图像文件

### 5.5 技术实现要点
- **前端**：使用HTML5 File API处理文件上传
- **图像处理**：使用Canvas API进行图像缩放和格式转换
- **拖拽实现**：基于HTML5 Drag & Drop API
- **服务器端**：使用multer中间件处理文件上传
- **数据结构**：作品数据中增加images字段存储图像信息
- **性能优化**：大图片异步加载，使用Web Workers处理图像